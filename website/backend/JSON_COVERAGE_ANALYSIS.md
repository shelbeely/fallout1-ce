# JSON Data Coverage Analysis

## Question: Does the JSON provide everything needed?

**Short Answer:** The base game JSON (`ai_state.json`, `ai_memory.json`, `ai_knowledge.json`) provides **most** of what's needed, but the backend `character_data_generator.py` extends it with additional structure for the terminal UI.

## What the Game Provides (Base Exports)

### ai_state.json (Updated Every Frame)
✅ **Available:**
- HP, Max HP, AP, Max AP
- Level, Experience, Armor Class
- SPECIAL stats (Strength, Perception, Endurance, Charisma, Intelligence, Agility, Luck)
- Skills (all 18 with values)
- Perks (name, level/rank)
- **Traits** (name, description) - **NEW in v2.1.0**
- Inventory (items with PID, name, quantity)
- Map name (current location)
- Combat status (in_combat flag)
- Session time, total kills, total damage
- Recent events (last 50)
- Nearby objects/NPCs
- **Karma** - **NEW in v2.1.0**
- **Reputation** - **NEW in v2.1.0**
- **Age and Gender** - **NEW in v2.1.0**
- **Additional derived stats** (healing_rate, critical_chance, damage_resistance, radiation_resistance, poison_resistance) - **NEW in v2.1.0**

### ai_memory.json (Persistent Decision Log)
✅ **Available:**
- Action history (action, target, result)
- Map/location where action occurred
- Timestamps
- Tile positions

### ai_knowledge.json (Game Encyclopedia)
✅ **Available:**
- Item database (weapons, armor, consumables with PIDs)
- Enemy database
- Game lore and context
- Available actions

## What the Frontend Needs

### ✅ Fully Covered by Base Game JSON

1. **Character Identity**
   - ✅ **Name** - **Now in game JSON** (v2.1.0) - from character creation
   - ✅ **Age** - **Now in game JSON** (v2.1.0)
   - ✅ **Gender** - **Now in game JSON** (v2.1.0)
   - ❌ Pronouns - NOT in game JSON (we use defaults: "they/them")
   - ✅ Origin - Can infer from starting location
   - ❌ Tagline - NOT in game JSON (we generate from quest context)

2. **Stats & Progression**
   - ✅ Level, Experience, HP, AP, AC - Direct from `ai_state.json`
   - ✅ SPECIAL - Direct from `ai_state.json`
   - ✅ Skills - Direct from `ai_state.json`
   - ✅ Perks - Direct from `ai_state.json`
   - ✅ **Traits** - **Now in game JSON** (v2.1.0)
   - ✅ **Derived stats** (healing rate, crit chance) - **Now in game JSON** (v2.1.0)

3. **Inventory**
   - ✅ All items with PID, name, quantity - Direct from `ai_state.json`
   - ✅ **Equipped items** (weapon/armor slots) - **Now in game JSON** (v2.1.0)
   - ❌ Notable items with flavor text - NOT in game JSON

4. **Karma & Reputation**
   - ✅ **Karma** - **Now in game JSON** (v2.1.0)
   - ✅ **Reputation** (overall) - **Now in game JSON** (v2.1.0)
   - ✅ **Town reputation** (per-faction hostile status) - **Now in game JSON** (v2.2.0)

5. **Quest Tracking**
   - ✅ **27 major quests** - **Now in game JSON** (v2.2.0) via global variables
   - ✅ **Quest progress values** - Direct from GVARs
   - ✅ **Quest names/descriptions** - **Added via quest_database.py** (sourced from Fallout wiki)
   - ✅ **Quest outcomes/consequences** - **Interpreted from GVAR values** via quest database
   - ✅ **Quest objectives** - Provided by quest database
   - ✅ **Quest rewards** - Provided by quest database
   - ✅ **Wiki links** - Each quest links to full Fallout wiki guide

6. **Location Discovery**
   - ✅ **12+ major locations known/visited status** - **Now in game JSON** (v2.2.0)
   - ✅ **Current player location ID** - **Now in game JSON** (v2.2.0)
   - ❌ Location coordinates - NOT in game JSON (we use hardcoded map)
   - ❌ Visit timestamps - NOT in game JSON (could track via memory)

### ⚠️ Partially Covered (Requires Processing)

4. **Map & Locations**
   - ✅ Current location - Direct from `ai_state.json` (map_name)
   - ❌ Visited locations list - Must parse from `ai_memory.json`
   - ❌ Location coordinates for map display - NOT in game JSON
   - ❌ Location metadata (first visit, events, NPCs) - Must aggregate from memory
   - ❌ Travel route - Must reconstruct from memory chronology

5. **Timeline**
   - ✅ Raw events - Direct from `ai_state.json` (recent_events)
   - ✅ Action history - Direct from `ai_memory.json`
   - ❌ Structured timeline with types - Must parse and categorize memory
   - ❌ Event links to quests/locations - Must generate relationships

6. **Quests**
   - ❌ Quest log - NOT in game JSON
   - ❌ Quest status (active/completed/failed) - NOT explicitly tracked
   - ❌ Quest outcomes - Must infer from memory/events
   - ⚠️ Main quest (water chip) - Could infer from game context

### ❌ Not in Game JSON (Generated by Backend)

7. **Journal Entries**
   - ❌ In-character narrative entries - NOT in game JSON
   - ❌ Dated journal entries - Must generate from session progress

8. **Relations & Reputation**
   - ❌ Karma - NOT in game JSON
   - ❌ Faction reputation - NOT in game JSON
   - ❌ Faction standings - NOT in game JSON

9. **Visual Assets**
   - ❌ Portrait URL - NOT in game JSON
   - ❌ Sprite URL - NOT in game JSON
   - ❌ Theme color - NOT in game JSON

10. **Stream Features**
    - ❌ Stream highlights - Must generate from current state
    - ❌ Location dossiers with summaries - Must create
    - ❌ Consequences tracking - NOT in game JSON

## What character_data_generator.py Does

The backend generator **bridges the gap** by:

### Data Transformation
1. **Parses ai_memory.json** → Creates structured timeline with event types
2. **Tracks map names in memory** → Builds visited locations list
3. **Analyzes action patterns** → Infers quest completions
4. **Aggregates events** → Creates location dossiers with events/NPCs

### Data Generation
1. **Generates quest log** - Adds main quest, infers side quests from memory
2. **Creates journal entries** - Synthesizes narrative from session data
3. **Builds location metadata** - Adds summaries, tags, consequences
4. **Generates stream highlights** - Top 5 bullets from current state

### Data Defaults
1. **Character identity** - Provides defaults for name/age/pronouns
2. **Visual assets** - Placeholder URLs for portraits/sprites
3. **Reputation system** - Starts with Vault 13 as Idolized
4. **Map coordinates** - Provides X/Y positions for location display

## Summary Table

| Feature | Game JSON | Generator Adds | Status |
|---------|-----------|----------------|--------|
| HP/Stats/Skills | ✅ Complete | - | Ready |
| SPECIAL | ✅ Complete | - | Ready |
| Perks | ✅ Complete | Descriptions | Enhanced |
| **Traits** | ✅ **Complete (v2.1.0)** | - | **Ready** |
| **Karma** | ✅ **Complete (v2.1.0)** | - | **Ready** |
| **Reputation** | ✅ **Complete (v2.1.0)** | - | **Ready** |
| **Derived Stats** | ✅ **Complete (v2.1.0)** | - | **Ready** |
| **Character Name** | ✅ **Complete (v2.1.0)** | Fallback if empty | **Ready** |
| **Equipped Items** | ✅ **Complete (v2.1.0)** | Flavor notes | **Ready** |
| **Quest Tracking** | ✅ **Complete (v2.2.0)** | Names, descriptions | **Ready** |
| **Town Reputation** | ✅ **Complete (v2.2.0)** | Friendly names | **Ready** |
| **Locations Known** | ✅ **Complete (v2.2.0)** | Coordinates, names | **Ready** |
| Inventory | ✅ Complete | Notable item notes | Enhanced |
| Current Location | ✅ Complete | - | Ready |
| Visited Locations | ⚠️ In memory | Extracts + coordinates | Generated |
| Timeline | ⚠️ Raw events | Types, links, structure | Generated |
| Quest Details | ⚠️ GVARs only | Full quest log with outcomes | Generated |
| Journal | ❌ Not present | Narrative entries | Generated |
| Map Visualization | ❌ Not present | Coordinates, routes | Generated |

## Recommendation: Extend Game Exports

To **fully cover** frontend needs without backend generation, the game should export:

### High Priority (Most Useful)
1. **Character name** - Let player set name at character creation
2. **Equipped items** - Mark which items are in weapon/armor slots
3. **Quest tracking** - Export active quest IDs and status
4. **Karma value** - Track and export karma score
5. **Faction reputation** - Track reputation with known factions

### Medium Priority
6. **Traits** - Export selected traits from character creation
7. **Location metadata** - First visit timestamps per location
8. **Quest outcomes** - Success/failure flags for completed quests

### Nice to Have
9. **Character pronouns** - Let player choose
10. **Portrait/sprite paths** - Reference to game assets
11. **Location coordinates** - X/Y on world map

## Current Solution Works

The **current implementation** is production-ready because:

✅ **Graceful fallback** - Frontend works with minimal data
✅ **Generated data is reasonable** - Defaults make sense (e.g., "Vault Dweller", Vault 13 origin)
✅ **Timeline works** - Memory provides enough data for event feed
✅ **Quest inference is possible** - Can detect main quest, major events
✅ **Stream highlights work** - Generated from available state

The backend generator effectively **fills the gaps** between what the game provides and what the terminal UI needs for a complete "Previously On..." experience.
